<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head') %>
<body>
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0"><i class="fa-solid fa-ticket"></i> <%= mode==='create'?'Create':'Edit' %> Voucher</h3>
    <div>
      <a class="btn btn-secondary" href="/vouchers/manage"><i class="fa-solid fa-arrow-left"></i> Back</a>
    </div>
  </div>
  <form method="post" action="<%= mode==='create'? '/vouchers/create' : '/vouchers/'+row.id+'/edit' %>" class="row g-3">
    <div class="col-md-4">
      <label class="form-label">Code</label>
      <input name="code" class="form-control" value="<%= row.code||'' %>" <%= mode==='create'?'':'required' %>>
      <div class="form-text">Leave blank to auto-generate (when creating).</div>
    </div>
    <div class="col-md-4">
      <label class="form-label">Title</label>
      <input name="title" class="form-control" required value="<%= row.title||'' %>">
    </div>
    <div class="col-md-2">
      <label class="form-label">Face Value</label>
      <input name="face_value" type="number" step="0.01" class="form-control" value="<%= row.face_value||0 %>">
    </div>
    <div class="col-md-2">
      <label class="form-label">Currency</label>
      <input name="currency" maxlength="3" class="form-control" value="<%= row.currency||'CAD' %>">
    </div>
    <div class="col-md-4">
      <label class="form-label">Salon</label>
      <select name="salon_id" class="form-select">
        <option value="">(None)</option>
        <% salons.forEach(s => { %>
          <option value="<%= s.id %>" <%= String(row.salon_id||'')===String(s.id)?'selected':'' %>><%= s.name %></option>
        <% }) %>
      </select>
    </div>
    <div class="col-md-4">
      <label class="form-label">Expires At</label>
      <input name="expires_at" type="datetime-local" class="form-control"
             value="<%= row.expires_at ? new Date(row.expires_at).toISOString().slice(0,16) : '' %>">
    </div>
    <div class="col-md-4">
      <label class="form-label">Status</label>
      <select name="status" class="form-select">
        <option value="AVAILABLE" <%= (row.status||'AVAILABLE')==='AVAILABLE'?'selected':'' %>>AVAILABLE</option>
        <option value="REDEEMED"  <%= row.status==='REDEEMED'?'selected':'' %>>REDEEMED</option>
        <option value="VOID"      <%= row.status==='VOID'?'selected':'' %>>VOID</option>
      </select>
    </div>
    <div class="col-12">
      <label class="form-label">Notes</label>
      <textarea name="notes" class="form-control" rows="2"><%= row.notes||'' %></textarea>
    </div>
    <div class="col-12">
      <button class="btn btn-primary"><i class="fa-solid fa-floppy-disk"></i> Save</button>
    </div>
  </form>
</div>
<%- include('../partials/foot') %>